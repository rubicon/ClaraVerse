# Docker Compose Override for Development
# This file is automatically loaded by docker-compose to override settings for local development
# To use production settings, rename this file or use: docker-compose -f docker-compose.yml up

services:
  backend:
    # Mount source code for hot reload (requires a file watcher in the app)
    volumes:
      # Mount source code (read-only for safety)
      - ./backend:/app/src:ro
      # Seed file is now in config directory (mounted in main docker-compose.yml)

    environment:
      # Development environment
      - ENVIRONMENT=development
      # Relaxed CORS for local development (includes both Vite ports and port 80)
      - ALLOWED_ORIGINS=http://localhost,http://localhost:5173,http://localhost:5174,http://localhost:3000,http://localhost:8080

    # Remove restart policy for development (easier to debug crashes)
    restart: "no"

    # Add labels for easier identification
    labels:
      - "dev.claraverse.environment=development"
      - "dev.claraverse.service=backend"

  # For development, it's recommended to run frontend with `npm run dev` locally
  # This provides hot reload and better developer experience
  # If you still want to use Docker for frontend in dev mode:
  frontend:
    # Use port 80 in development (same as production)
    restart: "no"
    labels:
      - "dev.claraverse.environment=development"
      - "dev.claraverse.service=frontend"